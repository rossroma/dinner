webpackJsonp([1],{153:function(e,t){},154:function(e,t){},155:function(e,t){},156:function(e,t){},160:function(e,t,a){"use strict";function s(e){a(156)}var r=a(98),n=a(164),o=a(44),i=s,l=o(r.a,n.a,!1,i,"data-v-46b42f02",null);t.a=l.exports},161:function(e,t,a){"use strict";function s(e){a(155)}var r=a(99),n=a(163),o=a(44),i=s,l=o(r.a,n.a,!1,i,null,null);t.a=l.exports},162:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",[a("h1",{staticClass:"title"},[e._v("逍邦网络点餐系统")]),e._v(" "),e.loginStatus?a("p",{staticClass:"login login-text"},[e._v("欢迎登录!")]):a("el-button",{staticClass:"login",attrs:{type:"text"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("登录")])],1),e._v(" "),a("el-main",[e.loginStatus?["orderList"===e.activeName?a("div",{staticClass:"dinner-status"},[a("el-switch",{staticClass:"switch",on:{change:e.handleSwitch},model:{value:e.dinnerStatus,callback:function(t){e.dinnerStatus=t},expression:"dinnerStatus"}}),e._v(" "),a("span",{staticClass:"text"},[e._v("点餐"+e._s(e.dinnerStatusText))])],1):a("el-date-picker",{staticClass:"date-picker",attrs:{size:"small",align:"right",type:"date",placeholder:"历史数据筛选","picker-options":e.pickerOptions},on:{change:e.getOrderList},model:{value:e.pickDate,callback:function(t){e.pickDate=t},expression:"pickDate"}})]:e._e(),e._v(" "),a("el-tabs",{staticClass:"tabs",on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"已点餐列表",name:"orderList"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.chooseMine,"show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"主食",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("typeFilter")(t.row.type))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"count",label:"数量",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("timeFilter")(t.row.createdAt))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.userName===e.myName||e.loginStatus?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.handleDelete(t.row.objectId)}}},[e._v("\n                撤销\n              ")]):e._e()]}}])})],1)],1),e._v(" "),e.loginStatus?a("el-tab-pane",{attrs:{label:"历史记录",name:"historyLog"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"show-summary":"","summary-method":e.getSummaries}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"主食",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("typeFilter")(t.row.type))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"count",label:"数量",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createdAt",label:"时间",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"备注"}})],1)],1):e._e()],1),e._v(" "),"orderList"===e.activeName?a("el-form",{ref:"formOrder",staticClass:"form-order",attrs:{inline:!0,model:e.formOrder,rules:e.rulesOrder}},[a("div",{staticClass:"row"},[a("el-form-item",{attrs:{prop:"userName"}},[a("el-input",{attrs:{size:"small",placeholder:"点餐人"},model:{value:e.formOrder.userName,callback:function(t){e.$set(e.formOrder,"userName",t)},expression:"formOrder.userName"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{size:"small",placeholder:"主食"},model:{value:e.formOrder.type,callback:function(t){e.$set(e.formOrder,"type",t)},expression:"formOrder.type"}},[a("el-option",{attrs:{value:1,label:"米饭"}}),e._v(" "),a("el-option",{attrs:{value:2,label:"馒头"}})],1)],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{size:"small",placeholder:"主食数量"},model:{value:e.formOrder.count,callback:function(t){e.$set(e.formOrder,"count",t)},expression:"formOrder.count"}},[a("el-option",{attrs:{value:.5}}),e._v(" "),a("el-option",{attrs:{value:1}}),e._v(" "),a("el-option",{attrs:{value:2}})],1)],1)],1),e._v(" "),a("div",{staticClass:"row"},[a("el-form-item",[a("el-input",{staticClass:"textarea",attrs:{type:"textarea",rows:4,resize:"none",placeholder:"备注信息"},model:{value:e.formOrder.others,callback:function(t){e.$set(e.formOrder,"others",t)},expression:"formOrder.others"}})],1),e._v(" "),a("el-form-item",[a("a",{staticClass:"login-btn normal",attrs:{href:"javascript:;"},on:{click:e.handleSubmit}},[e._v("我要点餐")])])],1)]):e._e()],2),e._v(" "),a("el-dialog",{attrs:{title:"管理员登录",width:"400",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"formLogin",attrs:{model:e.formLogin,rules:e.rulesLogin}},[a("el-form-item",{attrs:{label:"管理密码",prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入管理密码"},model:{value:e.formLogin.password,callback:function(t){e.$set(e.formLogin,"password",t)},expression:"formLogin.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登 录")])],1)],1)],1)},r=[],n={render:s,staticRenderFns:r};t.a=n},163:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main",attrs:{id:"order"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.btnShow,expression:"btnShow"}],staticClass:"orderItem"},[a("span",{domProps:{innerHTML:e._s(e.itemMsg)}}),e._v(" "),a("button",{on:{click:e.backout}},[e._v("撤销")])]),e._v(" "),a("div",{staticClass:"btnOut"},[a("div",{staticClass:"slideOut"},[a("transition",{attrs:{name:"slide-fade"}},[a("div",{staticClass:"orderForm"},[a("p",[e._v("姓名")]),e._v(" "),a("p",[e._v("主食")]),e._v(" "),a("p",[e._v("份数")]),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{prop:"userName"}},[a("el-input",{attrs:{size:"small",placeholder:"输入姓名"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"foodType"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.form.foodType,callback:function(t){e.$set(e.form,"foodType",t)},expression:"form.foodType"}},e._l(e.typeOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{prop:"count"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.form.count,callback:function(t){e.$set(e.form,"count",t)},expression:"form.count"}},e._l(e.countOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e}})}))],1),e._v(" "),a("el-input",{attrs:{type:"textarea",placeholder:"备注"},model:{value:e.form.others,callback:function(t){e.$set(e.form,"others",t)},expression:"form.others"}})],1)],1)]),e._v(" "),a("button",{staticClass:"orderBtn",style:e.styleClass,on:{click:e.onSubmit}},[e._v("\n          "+e._s(e.submitText)+"\n        ")])],1)])])},r=[],n={render:s,staticRenderFns:r};t.a=n},164:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"listView"},[a("div",{staticClass:"listBtn"},[a("el-switch",{attrs:{"on-text":"","off-text":""},on:{change:e.toggleDinner},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}}),e._v(" "),a("span",[e._v(e._s(e.status?"点餐开启":"点餐关闭"))])],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,stripe:"",width:"100%"}},[a("el-table-column",{attrs:{type:"index",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"主食",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"count",label:"数量",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createdAt",label:"时间",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"others",label:"备注",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.deleteRow(t.$index,t.row.objectId)}}},[e._v("\n            撤销\n          ")])]}}])})],1),e._v(" "),a("div",{staticClass:"tableSum"},[a("P",[e._v("米饭："),a("span",[e._v(e._s(e.rice))])]),e._v(" "),a("P",[e._v("馒头："),a("span",[e._v(e._s(e.buns))])])],1)],1)},r=[],n={render:s,staticRenderFns:r};t.a=n},167:function(e,t){},24:function(e,t,a){"use strict";var s=a(1),r=a(67);s.default.use(r.a);var n=function(e,t){s.default.http.get("/"+e).then(function(e){200===e.status?t(e.body):console.log(e.status)})},o=function(e,t,a){s.default.http.post("/"+e,t).then(function(e){200===e.status?a(e.body):console.log(e.status)})},i=function(){return{set:function(e,t){window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},remove:function(e){window.localStorage.removeItem(e)}}},l=new s.default;l.get=n,l.post=o,l.storage=i,t.a=l},46:function(e,t,a){"use strict";function s(e){return"object"===(void 0===e?"undefined":n()(e))&&(e=e.getTime()),new Date(e+288e5)}var r=a(5),n=a.n(r),o=a(1),i=a(67);o.default.use(i.a);var l=function(e,t){if(e)if("object"===(void 0===e?"undefined":n()(e)))e=s(e);else{if("number"!=typeof e){if("string"==typeof e){if(10===e.length||16===e.length)return e;if(24===e.length)return e=new Date(e),e=s(e),e.toISOString().slice(0,10)}throw new Error("Unknow this Date type, in utils.js, function formatDate")}10===e.toString().length&&(e*=1e3),e=s(e)}else e=s(new Date);return"datetime"===t?e.toISOString().substring(0,16).replace("T"," "):e.toISOString().slice(0,10)},u=new o.default;u.formatDate=l,t.a=u},69:function(e,t,a){"use strict";var s=a(1),r=a(165),n=a(161),o=a(160);s.default.use(r.a),t.a=new r.a({routes:[{path:"/",component:n.a},{path:"*",component:n.a},{path:"/YouNeverKnowThePath",component:o.a}]})},71:function(e,t){},72:function(e,t,a){"use strict";function s(e){a(154),a(153)}var r=a(97),n=a(162),o=a(44),i=s,l=o(r.a,n.a,!1,i,"data-v-21c8e972",null);t.a=l.exports},96:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1),r=a(70),n=a.n(r),o=a(71),i=(a.n(o),a(72)),l=a(69);s.default.config.productionTip=!1,s.default.use(n.a),new s.default({el:"#app",template:"<App/>",components:{App:i.a},router:l.a,render:function(e){return e(i.a)}})},97:function(e,t,a){"use strict";var s=a(5),r=a.n(s),n=a(24),o=a(46);t.a={name:"app",data:function(){return{activeName:"orderList",tableData:[],dialogFormVisible:!1,dinnerStatus:!1,myDinnerStatus:!1,myName:"",loginStatus:!1,formOrder:{userName:"",type:1,count:1,others:""},rulesOrder:{userName:{required:!0,message:"请输入点餐人姓名！",trigger:"blur"}},formLogin:{password:""},rulesLogin:{password:{required:!0,message:"请输入管理密码！",trigger:"blur"}},pickDate:"",pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"前天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-1728e5),e.$emit("pick",t)}}]}}},computed:{dinnerStatusText:function(){return this.dinnerStatus?"开启":"关闭"}},created:function(){this.getOrderList(),this.getLocalStorage()},methods:{getOrderList:function(e){var t=this;"object"===(void 0===e?"undefined":r()(e))&&(e=o.a.formatDate(e));var a=void 0;a=e?"getAllDinner?date="+e:"getAllDinner",n.a.get(a,function(e){t.dinnerStatus=e.result.dinnerStatus,t.tableData=e.result.results,t.loginStatus=e.result.loginStatus})},getLocalStorage:function(){var e=window.JSON.parse(n.a.storage().get("DINNER-userinfos"));e&&(this.formOrder.userName=this.myName=e.userName,this.formOrder.type=Number(e.type)||1,this.formOrder.count=Number(e.count)||1)},setLocalStorage:function(e){var t={userName:e.userName,type:e.type,count:e.count};t=window.JSON.stringify(t),n.a.storage().set("DINNER-userinfos",t)},handleSubmit:function(){var e=this;this.$refs.formOrder.validate(function(t){if(!t)return e.$message({type:"error",message:"输入有误，请检查后重新提交！"}),!1;-1===e.tableData.map(function(e){return e.userName}).indexOf(e.myName)?e.orderSubmit():e.$message({type:"error",message:"你已点餐，请勿重复提交！"})})},orderSubmit:function(){var e=this,t=this.formOrder;n.a.post("addDinner",t,function(a){1===a.code?(e.$message({type:"success",message:a.msg}),e.myDinnerStatus=!0,e.getOrderList(),e.setLocalStorage(t),e.myName=t.userName):e.$message({type:"error",message:a.msg})})},handleSwitch:function(){var e=this;n.a.get("toggleDinner",function(t){e.$message({type:"success",message:t.msg})})},handleTabClick:function(e){this.getOrderList()},login:function(){var e=this;this.$refs.formLogin.validate(function(t){if(!t)return e.$message({type:"error",message:"请输入管理密码！"}),!1;var a=e.formLogin;n.a.post("signin",a,function(t){1===t.code?(e.$message({type:"success",message:"登陆成功！"}),e.loginStatus=!0,e.dialogFormVisible=!1):e.$message({type:"error",message:"密码错误！"})})})},handleDelete:function(e){var t=this;this.$confirm("是否撤销此次点餐?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteRow(e)}).catch(function(){})},deleteRow:function(e){var t=this,a="cancelDinner/"+e;n.a.get(a,function(e){1===e.code?(t.$message({type:"success",message:e.msg}),t.myDinnerStatus=!1,t.getOrderList()):t.$message({type:"error",message:e.msg})})},chooseMine:function(e){return e.userName===this.myName?"positive-row":""},getSummaries:function(){var e=0,t=0;return this.tableData.forEach(function(a){1===a.type?e+=a.count:t+=a.count}),["统计","米饭："+e,"馒头："+t]}},filters:{typeFilter:function(e){return 1===e?"米饭":"馒头"},timeFilter:function(e){return e.slice(-8)}}}},98:function(e,t,a){"use strict";var s=a(24);t.a={name:"listView",data:function(){return{status:!0,tableData:[],rice:0,buns:0}},created:function(){function e(){var e=this;s.a.get("getAllDinner",function(t){if(1===t.code){e.status=t.result.dinnerStatus;var a=t.result.results;for(var s in a)1===a[s].count?a[s].count="0.5":2===a[s].count?a[s].count="1":3===a[s].count?a[s].count="2":a[s].count="3",1===a[s].type?(a[s].type="米饭",e.rice=parseFloat(a[s].count)+e.rice):(a[s].type="馒头",e.buns=parseFloat(a[s].count)+e.buns);e.tableData=a}else e.$message({type:"error",message:t.msg})})}e.bind(this)()},methods:{toggleDinner:function(){var e=this;s.a.get("toggleDinner",function(t){e.$message({type:"success",message:t.msg})})},deleteRow:function(e,t){var a=this,r="cancelDinner/"+t;s.a.get(r,function(t){1===t.code?(a.$message({type:"success",message:t.msg}),a.tableData.splice(e,1)):a.$message({type:"error",message:t.msg})})}}}},99:function(e,t,a){"use strict";var s=a(100),r=a.n(s),n=a(5),o=a.n(n),i=a(24),l=a(46);t.a={name:"order",data:function(){return{submitText:"我要点餐",styleClass:"",btnShow:!1,arrowClass:"el-icon-d-arrow-right",typeOption:[{value:1,label:"米饭"},{value:2,label:"馒头"}],countOption:[{value:1,label:"0.5"},{value:2,label:"1"},{value:3,label:"2"},{value:4,label:"3"}],form:{userName:"",foodType:"",count:"",others:""},rules:{userName:[{required:!0,message:"请输入姓名",trigger:"blur"}],foodType:[{required:!0,message:"请选择主食",trigger:"change",type:"object"}],count:[{required:!0,message:"请选择数量",trigger:"change",type:"object"}]},itemMsg:"",addDataStr:"",objectId:""}},created:function(){function e(){var e=this,t=JSON.parse(localStorage.addDataStr);this.form.userName=t.userName,1===t.type?this.form.foodType=this.typeOption[0]:this.form.foodType=this.typeOption[1],1===t.count?this.form.count=this.countOption[0]:2===t.count?this.form.count=this.countOption[1]:3===t.count?this.form.count=this.countOption[2]:this.form.count=this.countOption[3];var a="getDinner/"+t.userName;i.a.get(a,function(t){if(1===t.code){var a=t.result[0];if(a){var s=void 0,r=void 0;s=1===a.count?"0.5":2===a.count?"1":3===a.count?"2":"3",r=1===a.type?"米饭":"馒头",e.itemMsg="<em>"+a.createdAt+"</em><em>"+a.userName+"</em><em>"+r+"</em>("+s+")",e.btnShow=!0,e.styleClass="background:#efa867",e.submitText="已点餐",e.objectId=a.objectId}}else e.$message({type:"error",message:t.msg})})}localStorage.addDataStr&&e.bind(this)()},methods:{onSubmit:function(){var e=this,t=new Date,a=l.a.formatDate(t,"datetime");!1!==this.btnShow&&this.$message({type:"error",message:"您已点餐，如需重点，请先撤销！"}),this.$refs.form.validate(function(t){if(!t)return console.warn("error submit!!"),!1;e.itemMsg="<em>"+a+"</em><em>"+e.form.userName+"</em><em>"+e.form.foodType.label+"</em>("+e.form.count.label+")"});var s="getDinner/"+this.form.userName;i.a.get(s,function(t){var a=t.result;1===t.code?0!==a.length||void 0===(void 0===a?"undefined":o()(a))?e.$message({type:"error",message:"已有人帮您点餐，请勿重复点！"}):e.addFuntion():e.$message({type:"error",message:t.msg})})},addFuntion:function(){var e=this,t=new Date,a=l.a.formatDate(t,"datetime");if(!1===this.btnShow){var s={userName:this.form.userName,type:this.form.foodType.value,count:this.form.count.value,others:this.form.others};this.addDataStr=r()(s),i.a.storage().set("addDataStr",this.addDataStr);var n={type:this.form.foodType.label,count:this.form.count.label,myTime:a},o=r()(n);i.a.storage().set("viewDataStr",o),i.a.post("addDinner",s,function(t){1===t.code?(e.$message({type:"success",message:t.msg}),e.styleClass="background:#efa867",e.submitText="已点餐",e.btnShow=!0,e.objectId=t.result.objectId):e.$message({type:"error",message:t.msg})})}},resetForm:function(){this.$refs.form.resetFields()},backout:function(){var e=this;this.resetForm();var t="cancelDinner/"+this.objectId;i.a.get(t,function(t){1===t.code?(e.$message({type:"success",message:t.msg}),e.itemMsg="",e.styleClass="",e.submitText="我要点餐",e.btnShow=!1):e.$message({type:"error",message:t.msg})})}}}}},[96]);
//# sourceMappingURL=app.3488e3fd5de3800a700f.js.map